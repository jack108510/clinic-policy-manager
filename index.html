<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Policy Pro</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="logo.svg" alt="CSI Policy Manager Logo" class="logo-img">
                <span>CSI Policy Manager</span>
            </div>
            <div class="nav-menu">
                <a href="#home" class="nav-link" onclick="return requireLogin()">Home</a>
                <a href="#policies" class="nav-link" onclick="return requireLogin()">All Policies</a>
                <div class="dropdown">
                    <a href="#" class="nav-link dropdown-toggle" onclick="return requireLogin()">Policy Types <i class="fas fa-chevron-down"></i></a>
                    <div class="dropdown-content">
                        <a href="#admin" onclick="return requireLogin()">Admin Policies</a>
                        <a href="#sog" onclick="return requireLogin()">Standard Operating Guidelines</a>
                        <a href="#memos" onclick="return requireLogin()">Communication Memos</a>
                    </div>
                </div>
                <a href="#" onclick="showLoginModal()" class="nav-link">Login</a>
                <a href="#" onclick="showSignupModal()" class="nav-link">Sign Up</a>
                <a href="#" onclick="openPasswordModal()" class="nav-link">Admin Dashboard</a>
                <a href="#" onclick="showProfileModal()" class="nav-link">Profile Center</a>
                <a href="admin-master/index.html" class="nav-link master-admin-link">Master Admin</a>
            </div>
            <div class="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Policy Pro</h1>
            <p>Secure, organized, and compliant policy management for healthcare facilities</p>
            <div class="hero-buttons">
                <a href="#policies" class="btn btn-primary" onclick="return requireLogin()">View All Policies</a>
                <a href="#" onclick="openPasswordModal()" class="btn btn-secondary">Admin Dashboard</a>
            </div>
        </div>
    </section>

    <!-- Policy Types Section -->
    <section class="policy-types">
        <div class="container">
            <h2>Policy Categories</h2>
            <div class="policy-grid">
                <div class="policy-card" data-type="admin">
                    <div class="policy-icon">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <h3>Admin Policies</h3>
                    <p>Administrative procedures and governance policies</p>
                    <a href="#admin" class="btn btn-outline" onclick="return requireLogin()">View Admin Policies</a>
                </div>
                <div class="policy-card" data-type="sog">
                    <div class="policy-icon">
                        <i class="fas fa-clipboard-list"></i>
                    </div>
                    <h3>Standard Operating Guidelines</h3>
                    <p>Operational procedures and clinical guidelines</p>
                    <a href="#sog" class="btn btn-outline" onclick="return requireLogin()">View SOG</a>
                </div>
                <div class="policy-card" data-type="memos">
                    <div class="policy-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h3>Communication Memos</h3>
                    <p>Internal communications and announcements</p>
                    <a href="#memos" class="btn btn-outline" onclick="return requireLogin()">View Memos</a>
                </div>
            </div>
        </div>
    </section>


    <!-- All Policies Section -->
    <section id="policies" class="policies">
        <div class="container">
            <h2>All Policies</h2>
            <div class="search-bar">
                <input type="text" id="policySearch" placeholder="Search policies...">
                <i class="fas fa-search"></i>
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all" onclick="return requireLogin()">All Policies</button>
                <button class="filter-btn" data-filter="admin" onclick="return requireLogin()">Admin</button>
                <button class="filter-btn" data-filter="sog" onclick="return requireLogin()">Standard Operating Guidelines</button>
                <button class="filter-btn" data-filter="memos" onclick="return requireLogin()">Communication Memos</button>
            </div>
            <div class="policies-grid" id="policiesGrid">
                <!-- Policies will be loaded here -->
            </div>
        </div>
    </section>


    <!-- Create Policy Modal -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Policy</h3>
                <span class="close" onclick="closeCreateModal()">&times;</span>
            </div>
            <form id="policyForm" class="modal-body">
                <div class="form-group">
                    <label for="policyTitle">Policy Title</label>
                    <input type="text" id="policyTitle" required>
                </div>
                <div class="form-group">
                    <label for="policyType">Policy Type</label>
                    <select id="policyType" required onchange="updateManualFormFields()">
                        <option value="">Select Type</option>
                        <option value="admin">Admin Policy</option>
                        <option value="sog">Standard Operating Guidelines</option>
                        <option value="memo">Communication Memos</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="clinicApplicability">Organization Applicability</label>
                    <select id="clinicApplicability" multiple required>
                        <option value="tudor-glen">Tudor Glen</option>
                        <option value="river-valley">River Valley</option>
                        <option value="rosslyn">Rosslyn</option>
                        <option value="upc">UPC</option>
                    </select>
                </div>
                
                <!-- Dynamic form fields based on policy type -->
                <div id="dynamicManualFormFields">
                    <!-- Fields will be populated based on policy type selection -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeCreateModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Policy</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Settings</h2>
                <span class="close" onclick="closeSettingsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="tab-btn active" onclick="showSettingsTab('roles')">
                        <i class="fas fa-users"></i> Roles & Responsibilities
                    </button>
                    <button class="tab-btn" onclick="showSettingsTab('disciplinary')">
                        <i class="fas fa-gavel"></i> Disciplinary Actions
                    </button>
                    <button class="tab-btn" onclick="showSettingsTab('organizations')">
                        <i class="fas fa-building"></i> Organizations
                    </button>
                </div>
                
                <!-- Roles Tab -->
                <div id="rolesTab" class="settings-tab active">
                    <div class="settings-section">
                        <h3>Manage Roles & Responsibilities</h3>
                        <div class="add-item-form">
                            <input type="text" id="newRoleName" placeholder="Role name (e.g., Senior Veterinarian)">
                            <input type="text" id="newRoleDescription" placeholder="Role description">
                            <input type="text" id="newRoleStaffName" placeholder="Staff member name">
                            <input type="email" id="newRoleEmail" placeholder="Staff email">
                            <button onclick="addRole()" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Role
                            </button>
                        </div>
                        <div class="items-list" id="rolesList">
                            <!-- Roles will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Disciplinary Actions Tab -->
                <div id="disciplinaryTab" class="settings-tab">
                    <div class="settings-section">
                        <h3>Manage Disciplinary Actions</h3>
                        <div class="add-item-form">
                            <input type="text" id="newActionName" placeholder="Action name (e.g., Verbal Warning)">
                            <input type="text" id="newActionDescription" placeholder="Action description">
                            <input type="text" id="newActionPenalties" placeholder="Penalties (e.g., Written warning, Performance review)">
                            <select id="newActionSeverity">
                                <option value="minor">Minor</option>
                                <option value="moderate">Moderate</option>
                                <option value="major">Major</option>
                                <option value="severe">Severe</option>
                            </select>
                            <button onclick="addDisciplinaryAction()" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Action
                            </button>
                        </div>
                        <div class="items-list" id="disciplinaryList">
                            <!-- Disciplinary actions will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Organizations Tab -->
                <div id="organizationsTab" class="settings-tab">
                    <div class="settings-section">
                        <h3>Manage Organizations</h3>
                        <div class="add-item-form">
                            <input type="text" id="newOrganizationName" placeholder="Organization name (e.g., Downtown Clinic)">
                            <input type="text" id="newOrganizationAddress" placeholder="Organization address">
                            <input type="text" id="newOrganizationPhone" placeholder="Phone number">
                            <input type="email" id="newOrganizationEmail" placeholder="Email address">
                            <button onclick="addOrganization()" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Organization
                            </button>
                        </div>
                        <div class="items-list" id="organizationsList">
                            <!-- Organizations will be displayed here -->
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>


    <!-- AI Policy Chat Modal -->
    <div id="aiModal" class="modal">
        <div class="modal-content chat-modal">
            <div class="modal-header">
                <h3><i class="fas fa-robot"></i> AI Policy Assistant</h3>
                <p class="ai-subtitle">Create professional policies with AI assistance</p>
                <span class="close" onclick="closeAIModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="policy-type-selection">
                    <h4>Select Policy Type:</h4>
                    <div class="policy-type-toggles">
                        <label class="toggle-item">
                            <input type="radio" name="policyType" value="admin" checked>
                            <span class="toggle-label">Admin Policy</span>
                        </label>
                        <label class="toggle-item">
                            <input type="radio" name="policyType" value="sog">
                            <span class="toggle-label">Standard Operating Guidelines</span>
                        </label>
                        <label class="toggle-item">
                            <input type="radio" name="policyType" value="memo">
                            <span class="toggle-label">Communication Memo</span>
                        </label>
                    </div>
                </div>
                
                <div class="policy-options-selection">
                    <h4>Policy Options:</h4>
                    <div class="policy-options-grid">
                        <div class="option-group">
                            <h5>Applicable Organizations:</h5>
                            <div class="organization-toggles">
                                <!-- Organizations will be dynamically populated from admin settings -->
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <h5>Responsible Roles:</h5>
                            <div class="responsibility-toggles" id="responsibilityToggles">
                                <!-- Roles will be populated from settings -->
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <h5>Disciplinary Actions:</h5>
                            <div class="disciplinary-toggles" id="disciplinaryToggles">
                                <!-- Disciplinary actions will be populated from settings -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai-message">
                            <div class="message-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="message-content">
                                <p>Hello! I'm your AI Policy Assistant. I'll help you create a professional healthcare policy step by step.</p>
                                <p>Let's start with the basics. What type of policy would you like to create?</p>
                                <div class="quick-options">
                                    <button class="btn btn-sm btn-outline" onclick="selectPolicyType('admin')">Admin Policy</button>
                                    <button class="btn btn-sm btn-outline" onclick="selectPolicyType('sog')">Standard Operating Guidelines</button>
                                    <button class="btn btn-sm btn-outline" onclick="selectPolicyType('memo')">Communication Memo</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input">
                            <input type="text" id="chatInput" placeholder="Type your message here..." onkeypress="handleChatKeyPress(event)">
                            <button onclick="sendChatMessage()" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="chat-actions">
                            <button onclick="resetChat()" class="btn btn-sm btn-secondary">
                                <i class="fas fa-refresh"></i> Start Over
                            </button>
                            <button onclick="generatePolicyFromChat()" class="btn btn-sm btn-success" id="generatePolicyBtn" style="display: none;">
                                <i class="fas fa-magic"></i> Generate Policy
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Loading and Result Sections -->
                <div id="aiSurveyForm" style="display: none;">
                    <div class="survey-step active" id="step1">
                        <h4>Step 1: Policy Overview</h4>
                        <div class="form-group">
                            <label for="aiPolicyTopic">What type of policy do you need?</label>
                            <input type="text" id="aiPolicyTopic" placeholder="e.g., Fire Evacuation, Hand Hygiene, Patient Safety, Data Security" required>
                        </div>
                        <div class="form-group">
                            <label for="aiPolicyType">What type of document is this?</label>
                            <select id="aiPolicyType" required>
                                <option value="">Select Type</option>
                                <option value="admin">Admin Policy (Official policy with compliance requirements)</option>
                                <option value="sog">Standard Operating Guidelines (Step-by-step procedures)</option>
                                <option value="memo">Communication Memo (Staff announcement/update)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="aiClinicApplicability">Which organizations does this apply to?</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="clinics" value="tudor-glen"> Tudor Glen</label>
                                <label><input type="checkbox" name="clinics" value="river-valley"> River Valley</label>
                                <label><input type="checkbox" name="clinics" value="rosslyn"> Rosslyn</label>
                                <label><input type="checkbox" name="clinics" value="upc"> UPC</label>
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="nextStep(2)">Next</button>
                    </div>
                    
                    <div class="survey-step" id="step2">
                        <h4>Step 2: Policy Details</h4>
                        <div class="form-group">
                            <label for="aiSpecificNeeds">What specific needs or challenges does this policy address?</label>
                            <textarea id="aiSpecificNeeds" rows="3" placeholder="Describe the main issues, concerns, or goals this policy should address..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="aiUrgency">How urgent is this policy?</label>
                            <select id="aiUrgency">
                                <option value="immediate">Immediate (Need to implement right away)</option>
                                <option value="soon">Soon (Within the next month)</option>
                                <option value="planned">Planned (Part of regular policy updates)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="aiRegulations">Are there specific regulations or standards this must comply with?</label>
                            <textarea id="aiRegulations" rows="2" placeholder="e.g., OSHA, HIPAA, AAHA guidelines, local regulations..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="aiExistingPolicies">Are there existing policies this should reference or replace?</label>
                            <textarea id="aiExistingPolicies" rows="2" placeholder="List any current policies, procedures, or documents..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="aiSpecialConsiderations">Any special considerations or unique aspects?</label>
                            <textarea id="aiSpecialConsiderations" rows="2" placeholder="Any specific requirements, limitations, or considerations..."></textarea>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="prevStep(1)">Previous</button>
                        <button type="button" class="btn btn-primary" onclick="generatePolicyFromSurvey()">Generate Policy</button>
                    </div>
                </div>
                
                <!-- Legacy form (hidden) -->
                <form id="aiForm" style="display: none;">
                    <div class="ai-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeAIModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-magic"></i> Generate Policy
                        </button>
                    </div>
                </form>
                <div id="aiLoading" class="ai-loading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>AI is generating your policy...</p>
                </div>
                <div id="aiResult" class="ai-result" style="display: none;">
                    <h4>Generated Policy Preview</h4>
                    <div id="aiGeneratedContent"></div>
                    <div class="ai-result-actions">
                        <button class="btn btn-secondary" onclick="storeDraft()">Store Draft</button>
                        <button class="btn btn-outline" onclick="continueChat()">Continue Chat</button>
                        <button class="btn btn-secondary" onclick="editAIPolicy()">Edit Manually</button>
                        <button class="btn btn-success" onclick="exportPolicy('pdf')">
                            <i class="fas fa-file-pdf"></i> Export PDF
                        </button>
                        <button class="btn btn-info" onclick="exportPolicy('docx')">
                            <i class="fas fa-file-word"></i> Export Word
                        </button>
                        <button class="btn btn-primary" onclick="saveAIPolicy()">Save Final Policy</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- User Signup Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content signup-modal">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-user-plus"></i>
                </div>
                <h3>Join Your Company</h3>
                <p class="modal-subtitle">Create your account to access company policies</p>
                <span class="close" onclick="closeSignupModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="signupForm">
                    <div class="form-group">
                        <label for="signupUsername">Username</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="signupUsername" placeholder="Enter your username" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email Address</label>
                        <div class="input-group">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="signupEmail" placeholder="Enter your email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password</label>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="signupPassword" placeholder="Create a password" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="signupAccessCode">Access Code</label>
                        <div class="input-group">
                            <i class="fas fa-key"></i>
                            <input type="text" id="signupAccessCode" placeholder="Enter your company access code" required>
                        </div>
                        <small class="form-help">Access codes are created by administrators in the Master Admin dashboard. Contact your administrator for a valid code.</small>
                    </div>
                    <div id="signup-error-message" class="error-message"></div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <i class="fas fa-user-plus"></i>
                        Create Account
                    </button>
                    <div class="modal-footer">
                        <p>Already have an account? <a href="#" onclick="closeSignupModal(); showLoginModal();">Login here</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Policy Upload Modal -->
    <div id="uploadModal" class="modal">
        <div class="modal-content upload-modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-upload"></i> Upload Policy Documents</h3>
                <span class="close" onclick="closeUploadModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="upload-container">
                    <!-- Drag and Drop Area -->
                    <div id="uploadArea" class="upload-area">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Drag & Drop Your Policy Documents Here</h3>
                        <p>or click to browse</p>
                        <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.txt" style="display: none;">
                        <button type="button" class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                            <i class="fas fa-folder-open"></i>
                            Choose Files
                        </button>
                        <p class="upload-info">Supported formats: PDF, Word, Text files</p>
                    </div>

                    <!-- Processing Status -->
                    <div id="processingStatus" class="processing-status" style="display: none;">
                        <div class="processing-content">
                            <div class="processing-icon">
                                <i class="fas fa-cog fa-spin"></i>
                            </div>
                            <h3>Processing Documents...</h3>
                            <p id="processingMessage">Analyzing uploaded policies with AI</p>
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Uploaded Files Preview -->
                    <div id="uploadedFiles" class="uploaded-files" style="display: none;">
                        <h3>Uploaded Documents</h3>
                        <div id="fileList" class="file-list"></div>
                    </div>

                    <!-- AI Analysis Results -->
                    <div id="analysisResults" class="analysis-results" style="display: none;">
                        <h3>AI Analysis Results</h3>
                        <div id="analysisContent" class="analysis-content"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="clearUploadArea()">
                    <i class="fas fa-redo"></i> Clear
                </button>
                <button type="button" class="btn btn-primary" onclick="closeUploadModal()">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content login-modal">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-sign-in-alt"></i>
                </div>
                <h3>Welcome Back</h3>
                <p class="modal-subtitle">Sign in to access your company policies</p>
                <span class="close" onclick="closeLoginModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="loginForm" onsubmit="loginUser(event)">
                    <div class="form-group">
                        <label for="loginUsername">Username or Email</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="loginUsername" placeholder="Enter your username or email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="loginPassword" placeholder="Enter your password" required>
                        </div>
                    </div>
                    <div id="login-error-message" class="error-message"></div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <i class="fas fa-sign-in-alt"></i>
                        Sign In
                    </button>
                    <div class="modal-footer">
                        <p>Don't have an account? <a href="#" onclick="closeLoginModal(); showSignupModal();">Create one now</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Admin Access</h3>
                <span class="close" onclick="closePasswordModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="passwordForm">
                    <div class="form-group">
                        <label>Company Access:</label>
                        <div class="company-info" id="adminCompanyInfo">
                            <strong id="adminCompanyName">Loading...</strong>
                            <small id="adminCompanyUser">Loading...</small>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Enter Admin Password for <span id="adminPasswordCompanyName">your company</span>:</label>
                        <input type="password" id="adminPassword" placeholder="Enter your company's admin password" required>
                        <div id="error-message" class="error-message"></div>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="checkAdminPassword(event)">Access Admin</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div id="adminModal" class="modal">
        <div class="modal-content admin-modal-content">
            <div class="modal-header">
                <h3>Policy Pro Admin Dashboard</h3>
                <span class="close" onclick="closeAdminModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="admin-stats">
                    <div class="stat-card">
                        <i class="fas fa-file-alt"></i>
                        <h3 id="adminTotalPolicies">0</h3>
                        <p>Total Policies</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-edit"></i>
                        <h3 id="adminDraftCount">0</h3>
                        <p>Draft Policies</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <h3 id="adminUserCount">0</h3>
                        <p>Total Users</p>
                    </div>
                </div>
                
                <div class="admin-actions">
                    <button class="btn btn-primary" onclick="openCreateModal()">
                        <i class="fas fa-plus"></i> Create New Policy
                    </button>
                    <button class="btn btn-secondary" onclick="openAIModal()">
                        <i class="fas fa-robot"></i> AI Policy Generator
                    </button>
                    <button class="btn btn-info" onclick="openPoliciesModal()">
                        <i class="fas fa-file-alt"></i> Manage Policies
                    </button>
                    <button class="btn btn-primary" onclick="openUsersModal()" style="background: #8B5CF6; border-color: #8B5CF6;">
                        <i class="fas fa-users-cog"></i> Manage Users
                    </button>
                    <button class="btn btn-success" onclick="openUploadModal()">
                        <i class="fas fa-upload"></i> Upload Policy Documents
                    </button>
                    <button class="btn btn-warning" onclick="openSettingsModal()">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                    <button class="btn btn-danger" onclick="clearAllLocalStorage()">
                        <i class="fas fa-trash-alt"></i> Clear All Data
                    </button>
                </div>
                
                <!-- Draft Management Section -->
                <div class="draft-management">
                    <h3>Draft Policies</h3>
                    <div id="adminDraftList" class="draft-list">
                        <!-- Drafts will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Center Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content profile-modal-content">
            <div class="modal-header">
                <h3>Profile Center</h3>
                <span class="close" onclick="closeProfileModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="profile-section">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <h3 id="profileUserName">Guest User</h3>
                            <p id="profileUserCompany">Not logged in</p>
                            <span class="profile-status" id="profileUserStatus">Inactive</span>
                        </div>
                    </div>
                </div>

                <div class="profile-tabs">
                    <button class="tab-btn active" onclick="showProfileTab('account')">Account Info</button>
                    <button class="tab-btn" onclick="showProfileTab('security')">Security</button>
                    <button class="tab-btn" onclick="showProfileTab('preferences')">Preferences</button>
                </div>

                <!-- Account Info Tab -->
                <div id="accountTab" class="profile-tab active">
                    <div class="profile-section">
                        <h4>Account Information</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Username</label>
                                <span id="profileUsername">guest</span>
                            </div>
                            <div class="info-item">
                                <label>Email</label>
                                <span id="profileEmail">guest@example.com</span>
                            </div>
                            <div class="info-item">
                                <label>Company</label>
                                <span id="profileCompany">Not assigned</span>
                            </div>
                            <div class="info-item">
                                <label>Role</label>
                                <span id="profileRole">Guest</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Tab -->
                <div id="securityTab" class="profile-tab">
                    <div class="profile-section">
                        <h4>Security Settings</h4>
                        <div class="security-options">
                            <button class="btn btn-primary" onclick="showChangePasswordModal()">
                                <i class="fas fa-key"></i> Change Password
                            </button>
                            <button class="btn btn-secondary" onclick="showSessionInfo()">
                                <i class="fas fa-desktop"></i> Active Sessions
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Preferences Tab -->
                <div id="preferencesTab" class="profile-tab">
                    <div class="profile-section">
                        <h4>User Preferences</h4>
                        <div class="preference-options">
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox" checked>
                                    Email notifications for new policies
                                </label>
                            </div>
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox" checked>
                                    Weekly policy updates
                                </label>
                            </div>
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox">
                                    Daily activity summaries
                                </label>
                            </div>
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox" checked>
                                    System maintenance alerts
                                </label>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="saveUserPreferences()">
                            Save Preferences
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Change Password</h3>
                <span class="close" onclick="closeChangePasswordModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm" onsubmit="changeUserPassword(event)">
                    <div class="form-group">
                        <label for="currentPassword">Current Password</label>
                        <input type="password" id="currentPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">New Password</label>
                        <input type="password" id="newPassword" required minlength="8">
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Confirm New Password</label>
                        <input type="password" id="confirmPassword" required minlength="8">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeChangePasswordModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Change Password</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="logo.svg" alt="CSI Policy Manager Logo" class="logo-img">
                    <span>CSI Policy Manager</span>
                </div>
                <p>&copy; 2024 CSI Policy Manager. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js?v=30&t=20250127"></script>
</body>
</html>
