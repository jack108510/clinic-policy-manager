<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Policy Pro</title>
    <link rel="stylesheet" href="styles.css?v=206&t=20250128">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <!-- Landing Page (shown to non-logged-in users) -->
    <div id="landingPage" class="landing-page">
        <div class="landing-hero">
            <div class="landing-header">
                <div class="landing-logo">
                    <img src="policy-pro-logo.svg" alt="Policy Pro Logo" style="height: 60px;">
                </div>
                <div class="landing-auth">
                    <button onclick="showLoginModal()" class="btn-landing btn-login">
                        <i class="fas fa-sign-in-alt"></i> Log In
                    </button>
                    <button onclick="showSignupModal()" class="btn-landing btn-signup">
                        <i class="fas fa-user-plus"></i> Sign Up
                    </button>
                </div>
            </div>
            
            <div class="landing-content">
                <h1 class="landing-title">Policy Pro</h1>
                <p class="landing-subtitle">Secure, organized, and compliant policy management for healthcare facilities</p>
                <div class="landing-buttons">
                    <button onclick="showLoginModal()" class="btn btn-primary btn-large">Get Started</button>
                    <button onclick="showSignupModal()" class="btn btn-secondary btn-large">Create Account</button>
                </div>
            </div>
        </div>
        
        <section class="landing-about">
            <div class="container">
                <h2>About Policy Pro</h2>
                <div class="about-content">
                    <div class="about-card">
                        <div class="about-icon">
                            <i class="fas fa-file-shield"></i>
                        </div>
                        <h3>Secure Management</h3>
                        <p>Keep your policies organized and secure with enterprise-grade security features.</p>
                    </div>
                    <div class="about-card">
                        <div class="about-icon">
                            <i class="fas fa-robot"></i>
                        </div>
                        <h3>AI-Powered Creation</h3>
                        <p>Generate professional policies quickly with our AI assistant powered by ChatGPT.</p>
                    </div>
                    <div class="about-card">
                        <div class="about-icon">
                            <i class="fas fa-users-cog"></i>
                        </div>
                        <h3>Team Collaboration</h3>
                        <p>Manage team access, assign responsibilities, and track policy compliance.</p>
                    </div>
                    <div class="about-card">
                        <div class="about-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3>Stay Compliant</h3>
                        <p>Ensure your policies meet regulatory standards and best practices.</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="policy-pro-logo.svg" alt="Logo" class="logo-img">
            </div>
            <div class="nav-menu">
                <a href="#home" class="nav-link" onclick="return requireLogin()"><i class="fas fa-home"></i> Home</a>
                <a href="#policies" class="nav-link" onclick="return requireLogin()"><i class="fas fa-file-alt"></i> Policies</a>
                <span class="nav-divider"></span>
                <a href="#" onclick="openPasswordModal()" class="nav-link admin-link"><i class="fas fa-tachometer-alt"></i> Admin</a>
                <a href="#" onclick="showProfileModal()" class="nav-link"><i class="fas fa-user-circle"></i> Profile</a>
                <span class="nav-divider"></span>
                <a href="#" onclick="showLoginModal()" class="nav-link auth-btn">Login</a>
                <a href="#" onclick="showSignupModal()" class="nav-link auth-btn signup-btn">Sign Up</a>
                <span class="nav-divider"></span>
                <a href="admin-master/index.html" class="nav-link master-admin-link"><i class="fas fa-crown"></i> Master</a>
            </div>
            <div class="nav-toggle">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Policy Pro</h1>
            <p>Secure, organized, and compliant policy management</p>
            <div class="hero-buttons">
                <a href="#policies" class="btn btn-primary" onclick="return requireLogin()">View All Policies</a>
                <a href="#" onclick="openPasswordModal()" class="btn btn-secondary">Admin Dashboard</a>
            </div>
        </div>
    </section>

    <!-- Policy Types Section -->
    <section class="policy-types">
        <div class="container">
            <h2>Policy Categories</h2>
            <div class="policy-grid">
                <div class="policy-card" data-type="admin">
                    <div class="policy-icon">
                        <i class="fas fa-user-shield"></i>
                    </div>
                    <h3>Admin Policies</h3>
                    <p>Administrative procedures and governance policies</p>
                    <a href="#admin" class="btn btn-outline" onclick="return requireLogin()">View Admin Policies</a>
                </div>
                <div class="policy-card" data-type="sog">
                    <div class="policy-icon">
                        <i class="fas fa-clipboard-list"></i>
                    </div>
                    <h3>Standard Operating Guidelines</h3>
                    <p>Operational procedures and clinical guidelines</p>
                    <a href="#sog" class="btn btn-outline" onclick="return requireLogin()">View SOG</a>
                </div>
                <div class="policy-card" data-type="memos">
                    <div class="policy-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h3>Communication Memos</h3>
                    <p>Internal communications and announcements</p>
                    <a href="#memos" class="btn btn-outline" onclick="return requireLogin()">View Memos</a>
                </div>
            </div>
        </div>
    </section>


    <!-- All Policies Section -->
    <section id="policies" class="policies">
        <div class="container">
            <h2>All Policies</h2>
            <div class="search-bar">
                <input type="text" id="policySearch" placeholder="Search policies...">
                <i class="fas fa-search"></i>
            </div>
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all" onclick="return requireLogin()">All Policies</button>
                <button class="filter-btn" data-filter="admin" onclick="return requireLogin()">Admin</button>
                <button class="filter-btn" data-filter="sog" onclick="return requireLogin()">Standard Operating Guidelines</button>
                <button class="filter-btn" data-filter="memos" onclick="return requireLogin()">Communication Memos</button>
            </div>
            <div class="policies-grid" id="policiesGrid">
                <!-- Policies will be loaded here -->
            </div>
        </div>
    </section>


    <!-- Create Policy Modal -->
    <div id="createModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create New Policy</h3>
                <span class="close" onclick="closeCreateModal()">&times;</span>
            </div>
            <form id="policyForm" class="modal-body">
                <div class="form-group">
                    <label for="policyTitle">Policy Title</label>
                    <input type="text" id="policyTitle" required>
                </div>
                <div class="form-group">
                    <label for="policyType">Policy Type</label>
                    <select id="policyType" required onchange="updateManualFormFields()">
                        <option value="">Select Type</option>
                        <option value="admin">Admin Policy</option>
                        <option value="sog">Standard Operating Guidelines</option>
                        <option value="memo">Communication Memos</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="clinicApplicability">Organization Applicability</label>
                    <select id="clinicApplicability" multiple required>
                        <option value="tudor-glen">Tudor Glen</option>
                        <option value="river-valley">River Valley</option>
                        <option value="rosslyn">Rosslyn</option>
                        <option value="upc">UPC</option>
                    </select>
                </div>
                
                <!-- Dynamic form fields based on policy type -->
                <div id="dynamicManualFormFields">
                    <!-- Fields will be populated based on policy type selection -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeCreateModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary">Create Policy</button>
                </div>
            </form>
        </div>
    </div>


    <!-- Policy View Modal -->
    <div id="policyViewModal" class="modal" style="z-index: 2500;">
        <div class="modal-content" style="max-width: 900px;">
            <div class="modal-header">
                <h3 id="policyViewTitle">Policy Details</h3>
                <span class="close" onclick="closePolicyViewModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div id="policyViewContent">
                    <!-- Policy content will be inserted here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Policy Edit Modal -->
    <div id="policyEditModal" class="modal" style="z-index: 3500;">
        <div class="modal-content" style="max-width: 1000px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px;">
                <h3 style="margin: 0; color: white;"><i class="fas fa-edit"></i> Edit Policy</h3>
                <span class="close" onclick="closePolicyEditModal()" style="color: white;">&times;</span>
            </div>
            <div class="modal-body" style="padding: 25px;">
                <form id="policyEditForm" onsubmit="savePolicyEdit(event)">
                    <input type="hidden" id="editPolicyId">
                    
                    <!-- Basic Information -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-info-circle"></i> Basic Information
                        </h4>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                            <div class="form-group">
                                <label for="editPolicyTitle">Policy Title</label>
                                <input type="text" id="editPolicyTitle" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editPolicyType">Policy Type</label>
                                <select id="editPolicyType" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                    <option value="admin">Admin Policy</option>
                                    <option value="sog">Standard Operating Guidelines</option>
                                    <option value="protocol">Protocol</option>
                                    <option value="memo">Communication Memo</option>
                                </select>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 15px;">
                            <div class="form-group">
                                <label for="editPolicyEffectiveDate">Effective Date</label>
                                <input type="date" id="editPolicyEffectiveDate" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            </div>
                            
                            <div class="form-group">
                                <label for="editPolicyVersion">Version</label>
                                <input type="text" id="editPolicyVersion" value="1.0" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            </div>
                        </div>
                        
                        <div class="form-group" style="margin-top: 15px;">
                            <label for="editPolicyCode">Category</label>
                            <select id="editPolicyCode" onchange="updatePolicyCode()" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                                <option value="">Select a category (optional)</option>
                                <!-- Categories will be dynamically populated here -->
                            </select>
                            <small style="color: #666; display: block; margin-top: 5px;">Manage categories in Settings > Categories</small>
                        </div>
                        
                        <div class="form-group" id="policyCodeDisplay" style="margin-top: 15px; display: none;">
                            <label>Generated Policy Code</label>
                            <input type="text" id="editPolicyCodeDisplay" readonly style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; background: #f8f9fa; font-weight: bold; color: #667eea;">
                            <small style="color: #666; display: block; margin-top: 5px;">Code format: categoryNumber.policyNumberInCategory.year</small>
                        </div>
                    </div>
                    
                    <!-- Organizations -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-building"></i> Applicable Organizations
                        </h4>
                        <div id="editOrganizationsList">
                            <!-- Organizations checkboxes will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Policy Sections -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-file-text"></i> Policy Content
                        </h4>
                        
                        <div class="form-group">
                            <label for="editPolicyPurpose">Purpose</label>
                            <textarea id="editPolicyPurpose" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="State the purpose of this policy..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="editPolicyScope">Scope</label>
                            <textarea id="editPolicyScope" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Who does this policy apply to?"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="editPolicyStatement">Policy Statement</label>
                            <textarea id="editPolicyStatement" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="The main policy statement..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="editPolicyProcedures">Procedures</label>
                            <textarea id="editPolicyProcedures" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Step-by-step procedures..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="editPolicyResponsibilities">Responsibilities</label>
                            <textarea id="editPolicyResponsibilities" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="Who is responsible for what?"></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="editPolicyConsequences">Consequences / Non-Compliance</label>
                            <textarea id="editPolicyConsequences" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;" placeholder="What happens if not followed?"></textarea>
                        </div>
                    </div>
                    
                    <!-- Related Documents -->
                    <div style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                        <h4 style="margin: 0 0 15px 0; color: #333; display: flex; align-items: center; gap: 10px;">
                            <i class="fas fa-paperclip"></i> Related Documents
                        </h4>
                        <p style="margin-bottom: 15px; color: #666;">Link this policy to related documents</p>
                        <div id="editRelatedDocumentsList">
                            <!-- Document checkboxes will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Additional Content (for legacy or custom content) -->
                    <div class="form-group">
                        <label for="editPolicyContent">Additional Content (Optional)</label>
                        <textarea id="editPolicyContent" rows="5" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; font-family: monospace;" placeholder="Any additional notes or custom content..."></textarea>
                        <small style="color: #666;">Use this field for any additional information that doesn't fit in the structured fields above.</small>
                    </div>
                    
                    <div class="form-actions" style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 25px;">
                        <button type="button" class="btn btn-secondary" onclick="closePolicyEditModal()" style="padding: 12px 24px;">Cancel</button>
                        <button type="submit" class="btn btn-primary" style="padding: 12px 24px;">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-cog"></i> Settings</h2>
                <span class="close" onclick="closeSettingsModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="settings-tabs">
                    <button class="tab-btn active" onclick="showSettingsTab('roles')">
                        <i class="fas fa-users"></i> Roles & Responsibilities
                    </button>
                    <button class="tab-btn" onclick="showSettingsTab('disciplinary')">
                        <i class="fas fa-gavel"></i> Disciplinary Actions
                    </button>
                    <button class="tab-btn" onclick="showSettingsTab('organizations')">
                        <i class="fas fa-building"></i> Organizations
                    </button>
                    <button class="tab-btn" onclick="showSettingsTab('documents')">
                        <i class="fas fa-file-alt"></i> Documents
                    </button>
                    <button class="tab-btn" onclick="showSettingsTab('categories')">
                        <i class="fas fa-folder"></i> Categories
                    </button>
                    <button class="tab-btn" onclick="showSettingsTab('webhooks')">
                        <i class="fas fa-link"></i> Webhooks
                    </button>
                </div>
                
                <!-- Roles Tab -->
                <div id="rolesTab" class="settings-tab active">
                    <div class="settings-section">
                        <h3>Manage Roles & Responsibilities</h3>
                        <div class="add-item-form">
                            <input type="text" id="newRoleName" placeholder="Role name (e.g., Senior Veterinarian)">
                            <input type="text" id="newRoleDescription" placeholder="Role description">
                            <input type="text" id="newRoleStaffName" placeholder="Staff member name">
                            <input type="email" id="newRoleEmail" placeholder="Staff email">
                            <button onclick="addRole()" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Role
                            </button>
                        </div>
                        <div class="items-list" id="rolesList">
                            <!-- Roles will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Disciplinary Actions Tab -->
                <div id="disciplinaryTab" class="settings-tab">
                    <div class="settings-section">
                        <h3>Manage Disciplinary Actions</h3>
                        <div class="add-item-form">
                            <input type="text" id="newActionName" placeholder="Action name (e.g., Verbal Warning)">
                            <input type="text" id="newActionDescription" placeholder="Action description">
                            <input type="text" id="newActionPenalties" placeholder="Penalties (e.g., Written warning, Performance review)">
                            <select id="newActionSeverity">
                                <option value="minor">Minor</option>
                                <option value="moderate">Moderate</option>
                                <option value="major">Major</option>
                                <option value="severe">Severe</option>
                            </select>
                            <button onclick="addDisciplinaryAction()" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Action
                            </button>
                        </div>
                        <div class="items-list" id="disciplinaryList">
                            <!-- Disciplinary actions will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Organizations Tab -->
                <div id="organizationsTab" class="settings-tab">
                    <div class="settings-section">
                        <h3>Manage Organizations</h3>
                        <div class="add-item-form">
                            <input type="text" id="newOrganizationName" placeholder="Organization name (e.g., Downtown Clinic)">
                            <input type="text" id="newOrganizationAddress" placeholder="Organization address">
                            <input type="text" id="newOrganizationPhone" placeholder="Phone number">
                            <input type="email" id="newOrganizationEmail" placeholder="Email address">
                            <button onclick="addOrganization()" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Organization
                            </button>
                        </div>
                        <div class="items-list" id="organizationsList">
                            <!-- Organizations will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Documents Tab -->
                <div id="documentsTab" class="settings-tab">
                    <div class="settings-section">
                        <h3>Related Documents</h3>
                        <p style="margin-bottom: 20px; color: #666;">Store and manage documents that can be linked to policies</p>
                        
                        <div class="add-item-form">
                            <input type="text" id="newDocumentName" placeholder="Document name (e.g., HIPAA Compliance Guide)" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px;">
                            <input type="url" id="newDocumentUrl" placeholder="Document URL or file path" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px;">
                            <textarea id="newDocumentDescription" placeholder="Document description (optional)" rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; margin-bottom: 10px;"></textarea>
                            <button onclick="addDocument()" class="btn btn-primary">
                                <i class="fas fa-plus"></i> Add Document
                            </button>
                        </div>
                        
                        <div id="documentsList" class="items-list" style="margin-top: 20px;">
                            <!-- Documents will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Categories Tab -->
                <div id="categoriesTab" class="settings-tab">
                    <div class="settings-section">
                        <h2 style="color: #1f2937; margin-bottom: 10px; font-size: 1.8rem;">Policy Categories</h2>
                        <p style="margin-bottom: 30px; color: #666; font-size: 1rem;">Create and manage categories to organize your policies. Each category will automatically generate policy codes when assigned.</p>
                        
                        <div class="add-item-form" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 25px; border-radius: 12px; margin-bottom: 30px; box-shadow: 0 4px 20px rgba(102, 126, 234, 0.2);">
                            <h3 style="margin: 0 0 20px 0; color: white; font-size: 1.3rem;">Create New Category</h3>
                            <div style="display: grid; grid-template-columns: 1fr 150px; gap: 15px; align-items: end;">
                                <div>
                                    <label style="display: block; color: white; margin-bottom: 8px; font-weight: 500;">Category Name</label>
                                    <input type="text" id="newCategoryName" placeholder="e.g., Safety Policies" style="width: 100%; padding: 12px; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; background: rgba(255,255,255,0.95); font-weight: 500;">
                                </div>
                                <div>
                                    <label style="display: block; color: white; margin-bottom: 8px; font-weight: 500;">Number</label>
                                    <input type="number" id="newCategoryNumber" placeholder="e.g., 5" style="width: 100%; padding: 12px; border: 2px solid rgba(255,255,255,0.3); border-radius: 8px; background: rgba(255,255,255,0.95); font-weight: 500;">
                                </div>
                            </div>
                            <button onclick="addCategory()" class="btn btn-primary" style="margin-top: 20px; background: white; color: #667eea; border: none; padding: 12px 30px; font-weight: 600; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                                <i class="fas fa-plus"></i> Add Category
                            </button>
                        </div>
                        
                        <div id="categoriesList" class="items-list" style="margin-top: 20px;">
                            <!-- Categories will be displayed here -->
                        </div>
                    </div>
                </div>
                
                <!-- Webhooks Tab -->
                <div id="webhooksTab" class="settings-tab">
                    <div class="settings-section">
                        <h3>Configure Webhooks</h3>
                        <p style="margin-bottom: 20px; color: #666;">Set different webhook URLs for AI Policy Assistant and manual policy creation</p>
                        
                        <div class="form-group">
                            <label for="webhookUrlAI">
                                <i class="fas fa-robot"></i> AI Policy Assistant Webhook URL
                            </label>
                            <input type="text" id="webhookUrlAI" class="form-control" 
                                   placeholder="http://localhost:5678/webhook/your-ai-webhook-id" 
                                   style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            <small style="color: #666; display: block; margin-top: 5px;">
                                This webhook will be triggered when you create policies using the AI Policy Assistant
                            </small>
                        </div>
                        
                        <div class="form-group" style="margin-top: 20px;">
                            <label for="webhookUrlManual">
                                <i class="fas fa-edit"></i> Manual Policy Creation Webhook URL
                            </label>
                            <input type="text" id="webhookUrlManual" class="form-control" 
                                   placeholder="http://localhost:5678/webhook/your-manual-webhook-id" 
                                   style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            <small style="color: #666; display: block; margin-top: 5px;">
                                This webhook will be triggered when you create policies manually
                            </small>
                        </div>
                        
                        <div class="form-group" style="margin-top: 20px;">
                            <label for="webhookUrlReport">
                                <i class="fas fa-file-alt"></i> Policy Report Webhook URL
                            </label>
                            <input type="text" id="webhookUrlReport" class="form-control" 
                                   placeholder="http://localhost:5678/webhook-report" 
                                   style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            <small style="color: #666; display: block; margin-top: 5px;">
                                This webhook will send the full policy report and all company user emails when a policy is saved
                            </small>
                        </div>
                        
                        <div class="form-group" style="margin-top: 20px;">
                            <label for="emailWebhookUrl">
                                <i class="fas fa-envelope"></i> Email Webhook URL
                            </label>
                            <input type="text" id="emailWebhookUrl" class="form-control" 
                                   placeholder="http://localhost:5678/webhook/d523361e-1e04-4c16-a86e-bbb1d7729fcb" 
                                   style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            <small style="color: #666; display: block; margin-top: 5px;">
                                This webhook will be triggered when new users sign up and when new policies are created to send notification emails
                            </small>
                        </div>
                        
                        <button onclick="saveWebhookUrls()" class="btn btn-primary" style="margin-top: 20px;">
                            <i class="fas fa-save"></i> Save Webhook URLs
                        </button>
                        
                        <div id="webhookStatus" style="margin-top: 15px;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- AI Policy Chat Modal -->
    <div id="aiModal" class="modal">
        <div class="modal-content chat-modal">
            <div class="modal-header">
                <h3><i class="fas fa-robot"></i> AI Policy Assistant</h3>
                <p class="ai-subtitle">Create professional policies with AI assistance</p>
                <span class="close" onclick="closeAIModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="policy-type-selection">
                    <h4>Select Policy Type:</h4>
                    <div class="policy-type-toggles">
                        <label class="toggle-item">
                            <input type="radio" name="policyType" value="admin" checked>
                            <span class="toggle-label">Admin Policy</span>
                        </label>
                        <label class="toggle-item">
                            <input type="radio" name="policyType" value="sog">
                            <span class="toggle-label">Standard Operating Guidelines</span>
                        </label>
                        <label class="toggle-item">
                            <input type="radio" name="policyType" value="protocol">
                            <span class="toggle-label">Protocol</span>
                        </label>
                        <label class="toggle-item">
                            <input type="radio" name="policyType" value="memo">
                            <span class="toggle-label">Communication Memo</span>
                        </label>
                    </div>
                </div>
                
                <div class="policy-options-selection">
                    <h4>Policy Options:</h4>
                    <div class="policy-options-grid">
                        <div class="option-group">
                            <h5>Applicable Organizations:</h5>
                            <div class="organization-toggles">
                                <!-- Organizations will be dynamically populated from admin settings -->
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <h5>Responsible Roles:</h5>
                            <div class="responsibility-toggles" id="responsibilityToggles">
                                <!-- Roles will be populated from settings -->
                            </div>
                        </div>
                        
                        <div class="option-group">
                            <h5>Disciplinary Actions:</h5>
                            <div class="disciplinary-toggles" id="disciplinaryToggles">
                                <!-- Disciplinary actions will be populated from settings -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <div class="message ai-message">
                            <div class="message-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="message-content">
                                <p>Hello! I'm your AI Policy Assistant. I'll help you create a professional healthcare policy step by step.</p>
                                <p>Let's start with the basics. What type of policy would you like to create?</p>
                                <div class="quick-options">
                                    <button class="btn btn-sm btn-outline" onclick="selectPolicyType('admin')">Admin Policy</button>
                                    <button class="btn btn-sm btn-outline" onclick="selectPolicyType('sog')">Standard Operating Guidelines</button>
                                    <button class="btn btn-sm btn-outline" onclick="selectPolicyType('protocol')">Protocol</button>
                                    <button class="btn btn-sm btn-outline" onclick="selectPolicyType('memo')">Communication Memo</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="chat-input-container">
                        <div class="chat-input">
                            <input type="text" id="chatInput" placeholder="Type your message here..." onkeypress="handleChatKeyPress(event)">
                            <button onclick="sendChatMessage()" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i>
                            </button>
                        </div>
                        <div class="chat-actions">
                            <button onclick="resetChat()" class="btn btn-sm btn-secondary">
                                <i class="fas fa-refresh"></i> Start Over
                            </button>
                            <button onclick="generatePolicyFromChat()" class="btn btn-sm btn-success" id="generatePolicyBtn" style="display: none;">
                                <i class="fas fa-magic"></i> Generate Policy
                            </button>
                        </div>
                    </div>
                </div>
                <!-- Loading and Result Sections -->
                <div id="aiSurveyForm" style="display: none;">
                    <div class="survey-step active" id="step1">
                        <h4>Step 1: Policy Overview</h4>
                        <div class="form-group">
                            <label for="aiPolicyTopic">What type of policy do you need?</label>
                            <input type="text" id="aiPolicyTopic" placeholder="e.g., Fire Evacuation, Hand Hygiene, Patient Safety, Data Security" required>
                        </div>
                        <div class="form-group">
                            <label for="aiPolicyType">What type of document is this?</label>
                            <select id="aiPolicyType" required>
                                <option value="">Select Type</option>
                                <option value="admin">Admin Policy (Official policy with compliance requirements)</option>
                                <option value="sog">Standard Operating Guidelines (Step-by-step procedures)</option>
                                <option value="protocol">Protocol (Detailed procedures and workflows)</option>
                                <option value="memo">Communication Memo (Staff announcement/update)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="aiClinicApplicability">Which organizations does this apply to?</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" name="clinics" value="tudor-glen"> Tudor Glen</label>
                                <label><input type="checkbox" name="clinics" value="river-valley"> River Valley</label>
                                <label><input type="checkbox" name="clinics" value="rosslyn"> Rosslyn</label>
                                <label><input type="checkbox" name="clinics" value="upc"> UPC</label>
                            </div>
                        </div>
                        <button type="button" class="btn btn-primary" onclick="nextStep(2)">Next</button>
                    </div>
                    
                    <div class="survey-step" id="step2">
                        <h4>Step 2: Policy Details</h4>
                        <div class="form-group">
                            <label for="aiSpecificNeeds">What specific needs or challenges does this policy address?</label>
                            <textarea id="aiSpecificNeeds" rows="3" placeholder="Describe the main issues, concerns, or goals this policy should address..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="aiUrgency">How urgent is this policy?</label>
                            <select id="aiUrgency">
                                <option value="immediate">Immediate (Need to implement right away)</option>
                                <option value="soon">Soon (Within the next month)</option>
                                <option value="planned">Planned (Part of regular policy updates)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="aiRegulations">Are there specific regulations or standards this must comply with?</label>
                            <textarea id="aiRegulations" rows="2" placeholder="e.g., OSHA, HIPAA, AAHA guidelines, local regulations..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="aiExistingPolicies">Are there existing policies this should reference or replace?</label>
                            <textarea id="aiExistingPolicies" rows="2" placeholder="List any current policies, procedures, or documents..."></textarea>
                        </div>
                        <div class="form-group">
                            <label for="aiSpecialConsiderations">Any special considerations or unique aspects?</label>
                            <textarea id="aiSpecialConsiderations" rows="2" placeholder="Any specific requirements, limitations, or considerations..."></textarea>
                        </div>
                        <button type="button" class="btn btn-secondary" onclick="prevStep(1)">Previous</button>
                        <button type="button" class="btn btn-primary" onclick="generatePolicyFromSurvey()">Generate Policy</button>
                    </div>
                </div>
                
                <!-- Legacy form (hidden) -->
                <form id="aiForm" style="display: none;">
                    <div class="ai-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeAIModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-magic"></i> Generate Policy
                        </button>
                    </div>
                </form>
                <div id="aiLoading" class="ai-loading" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>AI is generating your policy...</p>
                </div>
                <div id="aiResult" class="ai-result" style="display: none;">
                    <h4>Generated Policy Preview</h4>
                    <div id="aiGeneratedContent"></div>
                    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #ddd;">
                        <h5 style="margin-bottom: 10px;">Refine This Policy</h5>
                        <p style="color: #666; margin-bottom: 15px;">Want to make changes? Send a follow-up prompt that includes the previous conversation context.</p>
                        <div class="chat-input" style="display: flex; gap: 10px;">
                            <input type="text" id="followUpInput" placeholder="Describe what you'd like to change or improve..." style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 4px;">
                            <button onclick="sendFollowUpPrompt()" class="btn btn-primary">
                                <i class="fas fa-paper-plane"></i> Send
                        </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Signup Type Selection Modal -->
    <div id="signupModal" class="modal">
        <div class="modal-content signup-modal" style="max-width: 500px;">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-user-plus"></i>
                </div>
                <h3>Create Account</h3>
                <p class="modal-subtitle">Choose how you'd like to sign up</p>
                <span class="close" onclick="closeSignupModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                    <button onclick="showCompanySignup()" class="btn btn-success" style="padding: 20px; font-size: 16px; text-align: left; background: #10b981; border-color: #10b981; width: 100%; display: flex; align-items: center;">
                        <i class="fas fa-building" style="font-size: 1.5rem; margin-right: 15px;"></i>
                        <div style="text-align: left;">
                            <strong style="display: block;">Register Your Company</strong>
                            <small style="display: block; opacity: 0.9; font-size: 0.85rem; margin-top: 4px;">Set up a new company account</small>
                        </div>
                    </button>
                    
                    <button onclick="showCompanyCodeSignup()" class="btn btn-outline" style="padding: 20px; font-size: 16px; text-align: left; border: 2px solid #667eea; color: #667eea; width: 100%; display: flex; align-items: center;">
                        <i class="fas fa-key" style="font-size: 1.5rem; margin-right: 15px;"></i>
                        <div style="text-align: left;">
                            <strong style="display: block;">Sign Up with Company Code</strong>
                            <small style="display: block; opacity: 0.9; font-size: 0.85rem; margin-top: 4px;">Join an existing company</small>
                        </div>
                    </button>
                </div>
                
                <div class="modal-footer" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e0e0e0;">
                    <p>Already have an account? <a href="#" onclick="closeSignupModal(); showLoginModal();">Log In</a></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Pricing Modal -->
    <div id="pricingModal" class="modal">
        <div class="modal-content" style="max-width: 1100px;">
            <div class="modal-header">
                <h3>Register Your Company</h3>
                <p class="modal-subtitle">Select a plan to register your company or sign up with a company code</p>
                <span class="close" onclick="closePricingModal()">&times;</span>
            </div>
            <div class="modal-body" style="padding: 40px;">
                <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 30px;">
                    <!-- Basic Plan -->
                    <div class="pricing-card" onclick="selectPlan('basic')" style="border: 2px solid #e0e0e0; border-radius: 12px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.3s;">
                        <h4 style="margin: 0 0 10px 0; color: #333;">Basic</h4>
                        <div style="font-size: 2.5rem; font-weight: bold; color: #667eea; margin: 20px 0;">
                            $29<span style="font-size: 1rem; color: #666;">/month</span>
                        </div>
                        <ul style="list-style: none; padding: 0; margin: 20px 0; text-align: left;">
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Up to 10 users</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Unlimited policies</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Basic AI assistant</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Email support</li>
                        </ul>
                        <button class="btn btn-outline" style="width: 100%;">Select Plan</button>
                    </div>
                    
                    <!-- Pro Plan -->
                    <div class="pricing-card" onclick="selectPlan('pro')" style="border: 3px solid #667eea; border-radius: 12px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.3s; background: #f8f9ff; position: relative;">
                        <div style="position: absolute; top: -15px; left: 50%; transform: translateX(-50%); background: #667eea; color: white; padding: 5px 20px; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">Most Popular</div>
                        <h4 style="margin: 15px 0 10px 0; color: #333;">Pro</h4>
                        <div style="font-size: 2.5rem; font-weight: bold; color: #667eea; margin: 20px 0;">
                            $99<span style="font-size: 1rem; color: #666;">/month</span>
                        </div>
                        <ul style="list-style: none; padding: 0; margin: 20px 0; text-align: left;">
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Up to 50 users</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Unlimited policies</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Advanced AI assistant</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Priority support</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Custom integrations</li>
                        </ul>
                        <button class="btn btn-primary" style="width: 100%;">Select Plan</button>
                    </div>
                    
                    <!-- Enterprise Plan -->
                    <div class="pricing-card" onclick="selectPlan('enterprise')" style="border: 2px solid #e0e0e0; border-radius: 12px; padding: 30px; text-align: center; cursor: pointer; transition: all 0.3s;">
                        <h4 style="margin: 0 0 10px 0; color: #333;">Enterprise</h4>
                        <div style="font-size: 2.5rem; font-weight: bold; color: #667eea; margin: 20px 0;">
                            $299<span style="font-size: 1rem; color: #666;">/month</span>
                        </div>
                        <ul style="list-style: none; padding: 0; margin: 20px 0; text-align: left;">
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Unlimited users</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Unlimited policies</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Premium AI assistant</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Dedicated support</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> Custom features</li>
                            <li style="margin: 10px 0;"><i class="fas fa-check" style="color: #10b981; margin-right: 8px;"></i> White-label options</li>
                        </ul>
                        <button class="btn btn-outline" style="width: 100%;">Select Plan</button>
                    </div>
                </div>
                <div style="text-align: center; color: #666; font-size: 0.9rem; margin-bottom: 30px;">
                    <p>All plans include a 14-day free trial. No credit card required.</p>
                </div>
                
                <div style="text-align: center; padding: 20px; background: #f8f9fa; border-radius: 12px; border: 2px dashed #d1d5db;">
                    <h4 style="margin: 0 0 10px 0; color: #333;">Already have a company code?</h4>
                    <p style="margin: 0 0 20px 0; color: #666;">Sign up using your company's access code</p>
                    <button onclick="showCompanyCodeSignup()" class="btn btn-outline" style="padding: 12px 30px; font-size: 1rem;">
                        <i class="fas fa-key"></i> Sign Up with Company Code
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Company Code Signup Modal -->
    <div id="companyCodeSignupModal" class="modal">
        <div class="modal-content signup-modal">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-key"></i>
                </div>
                <h3>Sign Up with Company Code</h3>
                <p class="modal-subtitle">Enter your company access code to join</p>
                <span class="close" onclick="closeCompanyCodeSignupModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="companyCodeSignupForm">
                    <div class="form-group">
                        <label for="companyCodeSignupUsername">Username</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="companyCodeSignupUsername" placeholder="Enter your username" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="companyCodeSignupEmail">Email Address</label>
                        <div class="input-group">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="companyCodeSignupEmail" placeholder="Enter your email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="companyCodeSignupPassword">Password</label>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="companyCodeSignupPassword" placeholder="Create a password" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="companyCodeSignupAccessCode">Company Access Code</label>
                        <div class="input-group">
                            <i class="fas fa-key"></i>
                            <input type="text" id="companyCodeSignupAccessCode" placeholder="Enter your company access code" required>
                        </div>
                        <small class="form-help">Get your access code from your company administrator</small>
                    </div>
                    <div id="company-code-signup-error-message" class="error-message"></div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <i class="fas fa-user-plus"></i>
                        Create Account
                    </button>
                    <div class="modal-footer">
                        <p>Want to register a new company? <a href="#" onclick="closeCompanyCodeSignupModal(); showCompanySignup();">View plans</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Individual Signup Modal -->
    <div id="individualSignupModal" class="modal">
        <div class="modal-content signup-modal">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-user"></i>
                </div>
                <h3>Create Personal Account</h3>
                <p class="modal-subtitle">Create your personal account</p>
                <span class="close" onclick="closeIndividualSignupModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="individualSignupForm">
                    <div class="form-group">
                        <label for="individualSignupUsername">Username</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="individualSignupUsername" placeholder="Enter your username" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="individualSignupEmail">Email Address</label>
                        <div class="input-group">
                            <i class="fas fa-envelope"></i>
                            <input type="email" id="individualSignupEmail" placeholder="Enter your email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="individualSignupPassword">Password</label>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="individualSignupPassword" placeholder="Create a password" required>
                        </div>
                    </div>
                    <div id="individual-signup-error-message" class="error-message"></div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <i class="fas fa-user-plus"></i>
                        Create Account
                    </button>
                    <div class="modal-footer">
                        <p>Already have an account? <a href="#" onclick="closeIndividualSignupModal(); showLoginModal();">Login here</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Policy Upload Modal -->
    <div id="uploadModal" class="modal" style="z-index: 3000;">
        <div class="modal-content upload-modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3><i class="fas fa-upload"></i> Upload Policy Documents</h3>
                <span class="close" onclick="closeUploadModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="upload-container">
                    <!-- Drag and Drop Area -->
                    <div id="uploadArea" class="upload-area">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Drag & Drop Your Policy Documents Here</h3>
                        <p>or click to browse</p>
                        <input type="file" id="fileInput" multiple accept=".pdf,.doc,.docx,.txt" style="display: none;">
                        <button type="button" class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                            <i class="fas fa-folder-open"></i>
                            Choose Files
                        </button>
                        <p class="upload-info">Supported formats: PDF, Word, Text files</p>
                    </div>

                    <!-- Processing Status -->
                    <div id="processingStatus" class="processing-status" style="display: none;">
                        <div class="processing-content">
                            <div class="processing-icon">
                                <i class="fas fa-cog fa-spin"></i>
                            </div>
                            <h3>Processing Documents...</h3>
                            <p id="processingMessage">Analyzing uploaded policies with AI</p>
                            <div class="progress-bar">
                                <div id="progressFill" class="progress-fill"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Uploaded Files Preview -->
                    <div id="uploadedFiles" class="uploaded-files" style="display: none;">
                        <h3>Uploaded Documents</h3>
                        <div id="fileList" class="file-list"></div>
                    </div>

                    <!-- AI Analysis Results -->
                    <div id="analysisResults" class="analysis-results" style="display: none;">
                        <h3>AI Analysis Results</h3>
                        <div id="analysisContent" class="analysis-content"></div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="clearUploadArea()">
                    <i class="fas fa-redo"></i> Clear
                </button>
                <button type="button" class="btn btn-primary" onclick="closeUploadModal()">
                    Done
                </button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content login-modal">
            <div class="modal-header">
                <div class="modal-icon">
                    <i class="fas fa-sign-in-alt"></i>
                </div>
                <h3>Welcome Back</h3>
                <p class="modal-subtitle">Sign in to access your company policies</p>
                <span class="close" onclick="closeLoginModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="loginForm" onsubmit="loginUser(event)">
                    <div class="form-group">
                        <label for="loginUsername">Username or Email</label>
                        <div class="input-group">
                            <i class="fas fa-user"></i>
                            <input type="text" id="loginUsername" placeholder="Enter your username or email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password</label>
                        <div class="input-group">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="loginPassword" placeholder="Enter your password" required>
                        </div>
                    </div>
                    <div id="login-error-message" class="error-message"></div>
                    <button type="submit" class="btn btn-primary btn-full">
                        <i class="fas fa-sign-in-alt"></i>
                        Sign In
                    </button>
                    <div class="modal-footer">
                        <p>Don't have an account? <a href="#" onclick="closeLoginModal(); showSignupModal();">Create one now</a></p>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Password Modal -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Admin Access</h3>
                <span class="close" onclick="closePasswordModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="passwordForm">
                    <div class="form-group">
                        <label>Company Access:</label>
                        <div class="company-info" id="adminCompanyInfo">
                            <strong id="adminCompanyName">Loading...</strong>
                            <small id="adminCompanyUser">Loading...</small>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="adminPassword">Enter Admin Password for <span id="adminPasswordCompanyName">your company</span>:</label>
                        <input type="password" id="adminPassword" placeholder="Enter your company's admin password" required>
                        <div id="error-message" class="error-message"></div>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="checkAdminPassword(event)">Access Admin</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Admin Modal -->
    <div id="adminModal" class="modal" style="z-index: 2000;">
        <div class="modal-content admin-modal-content">
            <div class="modal-header">
                <h3>Policy Pro Admin Dashboard</h3>
                <span class="close" onclick="closeAdminModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="admin-stats">
                    <div class="stat-card">
                        <i class="fas fa-file-alt"></i>
                        <h3 id="adminTotalPolicies">0</h3>
                        <p>Total Policies</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-edit"></i>
                        <h3 id="adminDraftCount">0</h3>
                        <p>Draft Policies</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <h3 id="adminUserCount">0</h3>
                        <p>Total Users</p>
                    </div>
                </div>
                
                <div class="admin-actions">
                    <button class="btn btn-primary" onclick="openCreateModal()">
                        <i class="fas fa-plus"></i> Create New Policy
                    </button>
                    <button class="btn btn-secondary" onclick="openAIModal()">
                        <i class="fas fa-robot"></i> AI Policy Generator
                    </button>
                    <button class="btn btn-info" onclick="openPoliciesModal()">
                        <i class="fas fa-file-alt"></i> Manage Policies
                    </button>
                    <button class="btn btn-primary" onclick="openUsersModal()" style="background: #8B5CF6; border-color: #8B5CF6;">
                        <i class="fas fa-users-cog"></i> Manage Users
                    </button>
                    <button class="btn btn-success" onclick="openUploadModal()">
                        <i class="fas fa-upload"></i> Upload Policy Documents
                    </button>
                    <button class="btn btn-warning" onclick="openSettingsModal()">
                        <i class="fas fa-cog"></i> Settings
                    </button>
                    <button class="btn btn-danger" onclick="clearAllLocalStorage()">
                        <i class="fas fa-trash-alt"></i> Clear All Data
                    </button>
                </div>
                
                <!-- Draft Management Section -->
                <div class="draft-management">
                    <h3>Draft Policies</h3>
                    <div id="adminDraftList" class="draft-list">
                        <!-- Drafts will be displayed here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Center Modal -->
    <div id="profileModal" class="modal">
        <div class="modal-content profile-modal-content">
            <div class="modal-header">
                <h3>Profile Center</h3>
                <span class="close" onclick="closeProfileModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="profile-section">
                    <div class="profile-header">
                        <div class="profile-avatar">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="profile-info">
                            <h3 id="profileUserName">Guest User</h3>
                            <p id="profileUserCompany">Not logged in</p>
                            <span class="profile-status" id="profileUserStatus">Inactive</span>
                        </div>
                    </div>
                </div>

                <div class="profile-tabs">
                    <button class="tab-btn active" onclick="showProfileTab('account')">Account Info</button>
                    <button class="tab-btn" onclick="showProfileTab('security')">Security</button>
                    <button class="tab-btn" onclick="showProfileTab('preferences')">Preferences</button>
                </div>

                <!-- Account Info Tab -->
                <div id="accountTab" class="profile-tab active">
                    <div class="profile-section">
                        <h4>Account Information</h4>
                        <div class="info-grid">
                            <div class="info-item">
                                <label>Username</label>
                                <span id="profileUsername">guest</span>
                            </div>
                            <div class="info-item">
                                <label>Email</label>
                                <span id="profileEmail">guest@example.com</span>
                            </div>
                            <div class="info-item">
                                <label>Company</label>
                                <span id="profileCompany">Not assigned</span>
                            </div>
                            <div class="info-item">
                                <label>Role</label>
                                <span id="profileRole">Guest</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Security Tab -->
                <div id="securityTab" class="profile-tab">
                    <div class="profile-section">
                        <h4>Security Settings</h4>
                        <div class="security-options">
                            <button class="btn btn-primary" onclick="showChangePasswordModal()">
                                <i class="fas fa-key"></i> Change Password
                            </button>
                            <button class="btn btn-secondary" onclick="showSessionInfo()">
                                <i class="fas fa-desktop"></i> Active Sessions
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Preferences Tab -->
                <div id="preferencesTab" class="profile-tab">
                    <div class="profile-section">
                        <h4>User Preferences</h4>
                        <div class="preference-options">
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox" checked>
                                    Email notifications for new policies
                                </label>
                            </div>
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox" checked>
                                    Weekly policy updates
                                </label>
                            </div>
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox">
                                    Daily activity summaries
                                </label>
                            </div>
                            <div class="preference-item">
                                <label>
                                    <input type="checkbox" checked>
                                    System maintenance alerts
                                </label>
                            </div>
                        </div>
                        <button class="btn btn-primary" onclick="saveUserPreferences()">
                            Save Preferences
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Change Password</h3>
                <span class="close" onclick="closeChangePasswordModal()">&times;</span>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm" onsubmit="changeUserPassword(event)">
                    <div class="form-group">
                        <label for="currentPassword">Current Password</label>
                        <input type="password" id="currentPassword" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword">New Password</label>
                        <input type="password" id="newPassword" required minlength="8">
                    </div>
                    <div class="form-group">
                        <label for="confirmPassword">Confirm New Password</label>
                        <input type="password" id="confirmPassword" required minlength="8">
                    </div>
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeChangePasswordModal()">Cancel</button>
                        <button type="submit" class="btn btn-primary">Change Password</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="policy-pro-logo.svg" alt="Logo" class="logo-img">
                </div>
                <p>&copy; 2024 Policy Pro. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js?v=105&t=20250128"></script>
</body>
</html>
